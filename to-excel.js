(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var t,n="Ricard FÃ­guls",o=function(){function e(){}return e.exportXLS=function(t,n,o){"string"==typeof(o=o||{filename:void 0})&&(o={filename:o}),o.extension=o.extension||"xls";var r=e.generateXML(t,n,o);return!1!==o.download&&e.download(o.filename+"."+o.extension,r),r},e.generateXML=function(t,o,r){var a="";return t.length&&o&&(a='<?xml version="1.0"?>\n<?mso-application progid="Excel.Sheet"?>\n<Workbook\nxmlns="urn:schemas-microsoft-com:office:spreadsheet"\nxmlns:o="urn:schemas-microsoft-com:office:office"\nxmlns:x="urn:schemas-microsoft-com:office:excel"\nxmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"\nxmlns:html="http://www.w3.org/TR/REC-html40">\n',a+='<DocumentProperties xmlns="urn:schemas-microsoft-com:office:office">\n<Author>%author</Author>\n<LastAuthor>%lastAuthor</LastAuthor>\n<Company>%company</Company>\n<Version>%version</Version>\n</DocumentProperties>\n'.replace("%author",e.parseXML(r.author||n)).replace("%lastAuthor",e.parseXML(r.lastAuthor||n)).replace("%company",e.parseXML(r.company||"RFM Software (Ricard Figuls)")).replace("%version",e.parseXML(r.version||"1")),a=(a+='<Styles>\n<Style ss:ID="hdr"><Font ss:Color="#ffffff" ss:Bold="1" /><Interior ss:Color="#000000" ss:Pattern="Solid"/></Style>\n</Styles>')+'<Worksheet ss:Name="'+r.filename+'"><Table>',a+="\n<Row>",a+=e.addHeaders(t),a+="</Row>",a+=e.addRows(o,t),a+="\n</Table></Worksheet>\n</Workbook>"),a},e.addHeaders=function(t){for(var n="",o=0,r=t;o<r.length;o++){var a=r[o];n+='\n<Cell ss:StyleID="hdr"><Data ss:Type="String">'+e.parseXML(a.label)+"</Data></Cell>"}return n},e.addRows=function(t,n){for(var o="",r=0,a=t;r<a.length;r++){var s=a[r];o+="\n<Row>";for(var l=0,i=n;l<i.length;l++){var c=i[l],u=c.type?c.type:"String",f=e.parseXML(e.getData(s,c.field));o=o+'<Cell><Data ss:Type="'+u+'">'+("Number"===u?+f:f)+"</Data></Cell>"}o+="\n</Row>"}return o},e.download=function(e,t){try{var n=new Blob([t],{type:"text/csv"});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(n,e);else{var o=window.document.createElement("a");o.href=window.URL.createObjectURL(n),o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o)}}catch(e){}},e.getData=function(t,n){var o=t;try{n.toString().split(".").forEach((function(e){o=o[e]}))}catch(e){o=void 0}return e.replaceValue(o)},e.setReplace=function(t,n){t&&n&&e.replaceItems.push({value:t,replacementValue:n})},e.parseXML=function(e){return null==e?"":e.toString().split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;").split('"').join("&quot;")},e.replaceValue=function(t){for(var n=0,o=e.replaceItems;n<o.length;n++){var r=o[n];if(r.value===t)return r.replacementValue}return t},e.replaceItems=[],e}(),r=(t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},t(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(o);e.g.toExcel=a})();