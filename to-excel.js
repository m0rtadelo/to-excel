(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var t,o="Ricard FÃ­guls",n=function(){function e(){}return e.exportXLS=function(t,o,n){"string"==typeof(n=n||{filename:void 0})&&(n={filename:n}),n.extension=n.extension||"xls";var r=e.generateXML(t,o,n);return!1!==n.download&&e.download(n.filename+"."+n.extension,r),r},e.generateXML=function(e,t,n){var r="";if(e.length&&t){r='<?xml version="1.0"?>\n<?mso-application progid="Excel.Sheet"?>\n<Workbook\nxmlns="urn:schemas-microsoft-com:office:spreadsheet"\nxmlns:o="urn:schemas-microsoft-com:office:office"\nxmlns:x="urn:schemas-microsoft-com:office:excel"\nxmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"\nxmlns:html="http://www.w3.org/TR/REC-html40">\n',r+='<DocumentProperties xmlns="urn:schemas-microsoft-com:office:office">\n<Author>%author</Author>\n<LastAuthor>%lastAuthor</LastAuthor>\n<Company>%company</Company>\n<Version>%version</Version>\n</DocumentProperties>\n'.replace("%author",n.author||o).replace("%lastAuthor",n.lastAuthor||o).replace("%company",n.company||"RFM Software (Ricard Figuls)").replace("%version",n.version||"1"),r=(r+='<Styles>\n<Style ss:ID="hdr"><Font ss:Color="#ffffff" ss:Bold="1" /><Interior ss:Color="#000000" ss:Pattern="Solid"/></Style>\n</Styles>')+'<Worksheet ss:Name="'+n.filename+'"><Table>',r+="\n<Row>";for(var a=0,s=e;a<s.length;a++){var i=s[a];r+='\n<Cell ss:StyleID="hdr"><Data ss:Type="String">'+this.parseXML(i.label)+"</Data></Cell>"}r+="</Row>";for(var l=0,c=t;l<c.length;l++){var u=c[l];r+="\n<Row>";for(var f=0,p=e;f<p.length;f++){var m=(i=p[f]).type?i.type:"String",h=this.parseXML(this.getData(u,i.field));r=r+'<Cell><Data ss:Type="'+m+'">'+("Number"===m?+h:h)+"</Data></Cell>"}r+="\n</Row>"}r+="\n</Table></Worksheet>\n</Workbook>"}return r},e.download=function(e,t){try{var o=new Blob([t],{type:"text/csv"});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(o,e);else{var n=window.document.createElement("a");n.href=window.URL.createObjectURL(o),n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n)}}catch(e){}},e.getData=function(t,o){var n=t;try{o.toString().split(".").forEach((function(e){n=n[e]}))}catch(e){n=void 0}return e.replaceValue(n)},e.setReplace=function(t,o){t&&o&&e.replaceItems.push({value:t,replacementValue:o})},e.parseXML=function(e){return void 0===e?"":e.toString().split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;").split('"').join("&quot;")},e.replaceValue=function(t){for(var o=0,n=e.replaceItems;o<n.length;o++){var r=n[o];if(r.value===t)return r.replacementValue}return t},e.replaceItems=[],e}(),r=(t=function(e,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},t(e,o)},function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(n);e.g.toExcel=a})();